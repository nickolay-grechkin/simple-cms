# Simple CMS

Проста система керування контентом (CMS), яка дозволяє створювати та керувати екранами з різними секціями та блоками контенту.
На клієнтський частині є два розділи (контент та схема). Розділ схема призначений для додавання, редагування, видалення секцій, розділ контент призначений для додавання, редагування, видалення блоків всередині секцій, також в цьому розділі є змога переглянути як дані будуть виглядати у форматі JSON.

## Структура проєкту

Проєкт складається з двох основних частин:

### Клієнтська частина (client)

- Розроблена з використанням React та TypeScript
- Використовує axios та react-query для запитів
- Використовує react-hook-from для менеджементу стейту та валідації форм
- Використовує chakra-ui як бібліотеку компонентів
- Використовує Vite як інструмент збірки
- Містить компоненти для керування екранами, секціями та блоками
- Взаємодіє з серверною частиною через REST API

### Серверна частина (server)

- Розроблена на Node.js з використанням Express та TypeScript
- Використовує MongoDB для зберігання даних
- Надає REST API для керування контентом
- Містить моделі даних для екранів, секцій та блоків

## Запуск проєкту

### Передумови

- Node.js (версія 16 або вище)
- npm або yarn
- Docker та Docker Compose (для запуску MongoDB)

### Запуск серверної частини

1. Перейдіть до директорії `server`:

```bash
cd server
```

2. Встановіть залежності:

```bash
npm install
```

3. Запустіть MongoDB за допомогою Docker Compose:

```bash
docker-compose up -d
```

Це запустить MongoDB на порту 27019. Ви можете підключитися до неї за адресою `mongodb://localhost:27019/simple-cms`.

4. Створіть файл `.env` з наступним вмістом:

```
PORT=3001
MONGODB_URI=mongodb://localhost:27019/simple-cms // Якщо використовується Docker контейнер
MONGODB_URI=mongodb://localhost:27017/simple-cms // Якщо НЕ використовується Docker контейнер
NODE_ENV=development
```

5. Запустіть seed для того, щоб записати в базу початкові дані

```bash
npm run seed
```

6. Запустіть сервер в режимі розробки:

```bash
npm run dev
```

Сервер буде доступний за адресою http://localhost:3001.

### Запуск клієнтської частини

1. Перейдіть до директорії `client`:

```bash
cd client
```

2. Встановіть залежності:

```bash
npm install
```

3. Створіть файл `.env` з наступним вмістом:

```
VITE_API_URL=http://localhost:3001
```

4. Запустіть клієнт в режимі розробки:

```bash
npm run dev
```

Клієнтський додаток буде доступний за адресою http://localhost:3000.

## Основні функції

- Створення та редагування екранів (в поточній версії додатку є можливість редагування лише одного екрану)
- Додавання різних типів секцій (банер, горизонтальний список, вертикальний список, сітка)
- Додавання та редагування блоків контенту в секціях
- Перетягування для зміни порядку секцій та блоків

## Формат JSON файлу

```json
{
  "_id": "67d689dd90e9f4c903a3fb12",
  "name": "Головний екран",
  "sections": [
    {
      "_id": "67d689dd90e9f4c903a3faff",
      "type": "banner",
      "title": "Баннер",
      "blocks": [
        {
          "_id": "67d689dd90e9f4c903a3fb00",
          "title": "Block 1",
          "description": "Description 1",
          "imageUrl": "https://images.pexels.com/photos/104827/cat-pet-animal-domestic-104827.jpeg",
          "videoUrl": "/block1"
        },
        {
          "_id": "67d689dd90e9f4c903a3fb01",
          "title": "Block 2",
          "description": "Description 2",
          "imageUrl": "https://images.pexels.com/photos/104827/cat-pet-animal-domestic-104827.jpeg",
          "videoUrl": "/block2"
        },
        {
          "_id": "67d689dd90e9f4c903a3fb02",
          "title": "Block 3",
          "description": "Description 3",
          "imageUrl": "https://images.pexels.com/photos/104827/cat-pet-animal-domestic-104827.jpeg",
          "videoUrl": "/block3"
        },
        {
          "_id": "67d689dd90e9f4c903a3fb03",
          "title": "Block 4",
          "description": "Description 4",
          "imageUrl": "https://images.pexels.com/photos/104827/cat-pet-animal-domestic-104827.jpeg",
          "videoUrl": "/block4"
        }
      ]
    }
  ]
}
```

### Екран (Screen)

```typescript
interface IScreen {
  _id: string;
  name: string;
  sections: ISection[];
  createdAt: Date;
  updatedAt: Date;
}
```

### Секція (Section)

```typescript
interface ISection {
  _id: string;
  type: "banner" | "vertical" | "horizontal" | "grid";
  title: string;
  blocks: IBlock[];
}
```

### Блок (Block)

```typescript
interface IBlock {
  _id: string;
  title: string;
  description: string;
  imageUrl: string;
  videoUrl: string;
}
```

## API Endpoints

### Екрани

- `GET /screen/all` - отримати всі екрани
- `PUT /screen` - редагувати екран

### Секції

- `POST /screen/section` - додати секцію до екрану
- `DELETE /screen/section ` - видалити секцію з екрану

## Майбутні покращення

- Дати користувачеві можливість додавати, редагувати та видаляти екрани.
- Імплементувати вибір типу блоку, який використовується в секції (текст, відео, посилання, фото), причому кожен тип може мати власні поля.
- У цій імплементації для зміни порядку секцій або блоків я покладаюся на порядок розташування елементів у MongoDB. Тобто, коли їх порядок змінюється на клієнті, у базі вони будуть збережені в оновленому порядку. Я обрав цей варіант через його простоту та швидкість реалізації. Проте, на мою думку, така реалізація не є практичною, оскільки порядок елементів може змінитися на якомусь етапі, що призведе до некоректного відображення в мобільному додатку. Щоб вирішити цю проблему, можна додати поле order, яке змінюватиметься відповідно до розташування елементів (1, 2, 3 тощо). Але при цій реалізації слід враховувати, що при додаванні або видаленні елемента з масиву порядкові значення інших елементів мають бути оновлені.
- Завантажувати зображення та відео через користувацький інтерфейс, а не просто вставляючи посилання.
- Заборонити реорганізацію блоків у секції, коли вони знаходяться у відкритому стані, оскільки анімація drag-and-drop працює некоректно.
- Відображати серверні помилки на клієнті через тост.
